(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{427:function(e,t,n){e.exports=n(588)},467:function(e,t){},588:function(e,t,n){"use strict";n.r(t);var r=n(625),c=(n(589),n(9)),o=n(1),i=n.n(o),a=n(7),s=n.n(a),u=n(12),l=n.n(u),f=Object(o.createContext)(Object.create(null)),j={s3credentials:{apiKey:void 0,apiSecret:void 0,region:void 0,endpoint:void 0,bucket:void 0},s3client:void 0,otherStuff:""},d=Object(o.createContext)(Object.create(null)),O=n(626),b=n(35),p=n.n(b),g=n(265),h=function(){var e=p()((function*(e){try{yield g.default.setItem("byos/application",JSON.stringify(e))}catch(t){}}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=p()((function*(){try{var e=yield g.default.getItem("byos/application");if(null!==e)return e}catch(t){}return""}));return function(){return e.apply(this,arguments)}}(),v=function(e){try{return JSON.parse(e)}catch(t){return{}}},m=function(){var e=p()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"{}",t=yield y();return v(t||e)}));return function(){return e.apply(this,arguments)}}(),x=n(617),P=n(611),w=n(210),S=n(21),C=n.n(S),D=n(619),E=n(606),k=(n(436),n(447),function(e){var t=e.credentials,n=e.region,r=e.endpoint,c=new D.S3Client({region:n,credentials:t,endpoint:r});return c.middlewareStack.add((function(e,t){return function(){var t=p()((function*(t){return yield e(t)}));return function(e){return t.apply(this,arguments)}}()}),{step:"finalizeRequest",name:"removeHeaders"}),c}),A=function(){var e=p()((function*(e,t){var n,r;console.log("[s3:getAssets] Making a List Objects command");var c=new E.ListObjectsCommand(t);console.log("[s3:getAssets] Command ",c),console.log("[s3:getAssets] Our s3 Client",e),console.log("[s3:getAssets] Sending command using client.send");var o=yield e.send(c),i=(null==(n=o.CommonPrefixes)?void 0:n.map((function(e){return{prefix:e.Prefix,etag:void 0,name:e.Prefix.replace("/",""),lastModified:void 0,size:0}})))||[],a=(null==(r=o.Contents)?void 0:r.map((function(e){return{etag:e.ETag,name:null==e?void 0:e.Key,lastModified:null==e?void 0:e.LastModified,size:null==e?void 0:e.Size}})))||[];return[].concat(C()(i),C()(a)).splice(0,30)}));return function(t,n){return e.apply(this,arguments)}}(),B=n(87),I=n(622),R=n(64),F=n(620),z=n(15);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c.default.create({input:{height:40,margin:12,borderWidth:1,padding:10}});var K=function(){return Object(z.jsx)(F.default,M({},arguments.length<=0?void 0:arguments[0]))},L=function(e){var t=e.control,n=e.name,r=e.label;if(void 0===t)return null;var o=c.default.create({textInput:{height:40,marginTop:20}});return Object(z.jsx)(z.Fragment,{children:Object(z.jsx)(w.Controller,{control:t,name:n,render:function(e){var t=e.field,c=t.value,i=t.onChange,a=t.onBlur;return Object(z.jsx)(z.Fragment,{children:Object(z.jsx)(K,{name:n,label:r,value:c,onChangeText:function(e){console.log("[InputChange] name = ",n," value = ",e),i(e)},onBlur:a,style:o.textInput})})}})})},T=n(228);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H=function(){return Object(z.jsx)(T.default,G({},arguments.length<=0?void 0:arguments[0]))},J=n(67),Q=n(359),W=n(13),Y=n(11),q=n(607);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=function(){return Object(z.jsx)(q.default,U({},arguments.length<=0?void 0:arguments[0]))};function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee=function(){var e=Object(o.useContext)(d),t=l()(e,2),n=t[0],r=t[1],a=n.s3credentials,s=Object(w.useForm)({defaultValues:a}),u=s.control,f=s.handleSubmit,j=(s.formState,s.getValues),O=s.reset;Object(o.useEffect)((function(){O(a)}),[a]);var b=Object(o.useState)(!1),p=l()(b,2),g=(p[0],p[1]),h=i.a.useState(""),y=l()(h,2),v=(y[0],y[1],i.a.useState(!1)),m=l()(v,2),x=m[0],P=m[1],S=function(){return P(!x)},C=c.default.create({container:{flex:1},inner:{padding:24,flex:1,justifyContent:"space-around"},header:{fontSize:36,marginBottom:48},textInput:{height:40,borderColor:"#000000",borderBottomWidth:1,marginBottom:36},snackBarContainer:{flex:1,justifyContent:"space-between"}});return Object(z.jsxs)(J.default,{children:[Object(z.jsx)(Q.default,{behavior:"ios"===W.default.OS?"padding":"height",style:C.container,children:Object(z.jsx)(B.default,{style:C.inner,children:Object(z.jsxs)(I.default,{children:[Object(z.jsxs)(I.default.Content,{children:[Object(z.jsx)(R.default,{variant:"headlineSmall",children:"API Configuration"}),Object(z.jsx)(L,{control:u,name:"apiKey",label:"API KEY"}),Object(z.jsx)(L,{control:u,name:"apiSecret",label:"Api Secret"}),Object(z.jsx)(L,{control:u,name:"endpoint",label:"Endpoint"}),Object(z.jsx)(L,{control:u,name:"bucket",label:"Bucket"}),Object(z.jsx)(L,{control:u,name:"region",label:"Region"})]}),Object(z.jsx)(I.default.Actions,{children:Object(z.jsx)(H,{onPress:f((function(){S();var e=j();console.log("[SaveCredentialsForm] Saving data = ",e),r(_(_({},n),{},{s3credentials:e,s3client:void 0})),g(!0),setTimeout((function(){g(!1)}),1e3);var t=k({credentials:{accessKeyId:e.apiKey,secretAccessKey:e.apiSecret},region:e.region,endpoint:e.endpoint});A(t,{Bucket:"testinghumza"})})),children:"Submit"})})]})})}),Object(z.jsx)(Y.default,{style:C.snackBarContainer,children:Object(z.jsx)(X,{visible:x,onDismiss:function(){return P(!1)},action:{label:"Dismiss",onPress:function(){}},children:"Credentials are saved!"})})]})},te=function(){return Object(z.jsx)(ee,{})},ne=n(608),re=function(e){return e.map((function(e){var t;return{assetId:e.etag,fileName:e.name,fileSize:e.size,updatedAt:e.lastModified,isFolder:(null==(t=e.prefix)?void 0:t.length)>0,prefix:e.prefix}}))},ce=n(137),oe=function(){var e=i.a.useState(null),t=l()(e,1)[0];Boolean(t);return Object(z.jsx)(z.Fragment,{})},ie=n(369),ae=n(257),se=n.n(ae),ue=n(370),le=n.n(ue),fe=n(609),je=n(610);se.a.extend(le.a);var de=function(e){switch(e.isFolder?"folder":/(?:\.([^.]+))?$/.exec(e.fileName)[1]||""){case"folder":return Object(z.jsx)(fe.default,{name:"folder1",size:24});case"txt":return Object(z.jsx)(je.default,{name:"file-text",size:24});default:return Object(z.jsx)(je.default,{name:"file",size:24})}},Oe=function(){var e=Object(ce.createColumnHelper)();return[e.accessor("fileName",{header:"Name",cell:function(e){return Object(z.jsxs)(z.Fragment,{children:[de(e.row.original)," ",e.getValue()]})}}),e.accessor("fileSize",{header:"Size",cell:function(e){return Object(ie.default)(e.getValue())}}),e.accessor("updatedAt",{header:"Last Modified",cell:function(e){return se()(e.getValue()).fromNow()}}),e.display({id:"actions",cell:function(){return Object(z.jsx)(oe,{})}})]},be=n(623),pe=function(e){var t=e.assets,n=e.onPress,r=i.a.useState((function(){return t||[]})),c=l()(r,2),a=c[0],s=c[1];Object(o.useEffect)((function(){s(t||[])}),[t]);var u=Object(ce.useReactTable)({data:a,columns:Oe(),getCoreRowModel:Object(ce.getCoreRowModel)()});return Object(z.jsxs)(be.default,{children:[Object(z.jsx)(be.default.Header,{children:u.getHeaderGroups().map((function(e){return Object(z.jsx)(z.Fragment,{children:e.headers.map((function(e){return Object(z.jsx)(be.default.Title,{children:e.isPlaceholder?null:Object(ce.flexRender)(e.column.columnDef.header,e.getContext())},e.id)}))})}))}),Object(z.jsx)(J.default,{children:u.getRowModel().rows.map((function(e){return Object(z.jsx)(be.default.Row,{onPress:function(){n(e.original)},children:e.getVisibleCells().map((function(e){return Object(z.jsx)(be.default.Cell,{children:Object(z.jsx)(R.default,{children:Object(ce.flexRender)(e.column.columnDef.cell,e.getContext())})},e.id)}))},e.id)}))})]})},ge=n(358);function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ve=function(){var e,t=Object(o.useState)(""),n=l()(t,2),r=(n[0],n[1],Object(o.useState)("")),c=l()(r,2),i=c[0],a=c[1],s=Object(o.useContext)(d),u=l()(s,1)[0],f=function(e){var t=e.s3credentials,n=t.apiKey,r=t.apiSecret,c=t.region,i=t.endpoint;return Object(o.useMemo)((function(){if(n&&r&&i)return console.log("[useS3Client] Building S3 Client region = ",c),console.log("[useS3Client] Building S3 Client apiKey = ",n),k({region:c,credentials:{accessKeyId:n,secretAccessKey:r},endpoint:i})}),[n,r,c,i])}(u),j=Object(o.useState)({Bucket:u.s3credentials.bucket,Prefix:"",Delimiter:"/"}),O=l()(j,2),b=O[0],g=O[1];Object(o.useEffect)((function(){g(ye(ye({},b),{},{Bucket:u.s3credentials.bucket}))}),[u,f]);var h=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=Object(ne.useQuery)(["getAssets",n,t.Bucket||"",t.Delimiter||"",t.Prefix||""],p()((function*(){try{console.log("[useGetAssets] Getting data ");var n=yield A(e,t);return re(n)}catch(r){console.log("[useGetAssets] Error : ",r)}return[]})));return r}(f,b,i),y=h.data,v=h.isLoading,m=h.isError,x=function(e){g(ye(ye({},b),{},{Prefix:e}))};return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(H,{onPress:function(){a(""+Math.random())},mode:"outlined",children:"Reload"}),(null==(e=b.Prefix)?void 0:e.length)>0&&Object(z.jsx)(H,{onPress:function(){!function(){var e=b.Prefix;if(""!==e){var t=e.replace("/","").lastIndexOf("/");if(t<0)x("");else{var n=e.substring(0,t);console.log("New : ",n),x(n)}}}()},mode:"outlined",children:"Go back"}),v&&Object(z.jsx)(ge.default,{animating:!0}),m&&Object(z.jsx)(R.default,{variant:"headlineSmall",children:"Error "}),y&&!1===v&&Object(z.jsx)(pe,{assets:y,onPress:function(e){e.isFolder&&x(e.prefix)}})]})};function me(){return Object(z.jsx)(ve,{})}var xe=n(621),Pe=n(375),we=function(e){var t=e.navigation;e.route,e.options;return Object(z.jsxs)(xe.default.Header,{elevated:!0,children:[Object(z.jsx)(xe.default.Action,{icon:"menu",onPress:function(){"open"===Object(Pe.default)(t.getState())?t.closeDrawer():t.openDrawer()}}),Object(z.jsx)(xe.default.Content,{title:"Bring Your Own Server"}),Object(z.jsx)(xe.default.Action,{icon:"refresh"})]})},Se=Object(P.default)(),Ce=function(){return Object(z.jsx)(x.default,{children:Object(z.jsxs)(Se.Navigator,{useLegacyImplementation:!0,initialRouteName:"ApiConfiguration",screenOptions:{header:function(e){var t=e.navigation,n=e.route,r=e.options;return Object(z.jsx)(we,{navigation:t,route:n,options:r})}},children:[Object(z.jsx)(Se.Screen,{name:"Dashboard",component:me}),Object(z.jsx)(Se.Screen,{name:"Configuration",component:te})]})})};function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ee=function(){var e=i.a.useContext(f),t=l()(e,1)[0],n=function(e){var t=Object(o.useState)(e),n=l()(t,2),r=n[0],c=n[1],i=Object(o.useState)(!1),a=l()(i,2),s=a[0],u=a[1];return Object(o.useMemo)((function(){m(JSON.stringify(e)).then((function(e){c(e),u(!0)}))}),[e]),{data:r,isLoaded:s}}(j),r=n.data,c=n.isLoaded,a=Object(o.useState)(r),u=l()(a,2),b=u[0],p=u[1];return Object(o.useEffect)((function(){p(r)}),[r]),Object(o.useEffect)((function(){var e;c&&(console.log("[App] Application state was updated = ",b),e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},b),h(e))}),[b,c]),Object(z.jsx)(O.default,{children:Object(z.jsxs)(d.Provider,{value:a,children:[t.isReady&&t.routes.map((function(e){return null})),Object(z.jsx)(Ce,{})]})})};function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Be=function(){return Object(z.jsx)(Y.default,Ae({},arguments.length<=0?void 0:arguments[0]))},Ie=function(){return Object(z.jsx)(T.default,Ae({},arguments.length<=0?void 0:arguments[0]))};function Re(e){var t=e.children,n=(e.isOpen,e.handleClose);return Object(z.jsxs)(Be,{style:{marginTop:100},children:[Object(z.jsx)(Ie,{onPress:function(){return n()},children:"Close"}),t]})}var Fe={isReady:!1,routes:[{path:"/credentials",component:Object(z.jsx)((function(){return Object(z.jsx)(z.Fragment,{children:Object(z.jsx)(Re,{isOpen:!1,handleClose:function(){},children:Object(z.jsx)(ee,{})})})}),{}),showInNavigation:!0},{path:"/",component:Object(z.jsx)((function(){return Object(z.jsx)(z.Fragment,{})}),{}),showInNavigation:!0}]};function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Me=function(e){var t=e.children,n=i.a.useContext(f),r=l()(n,2),c=r[0],a=r[1];return Object(o.useEffect)((function(){!1===c.isReady&&a(Ne(Ne({},c),{},{isReady:!0}))}),[c.isReady,c.routes]),Object(z.jsx)(z.Fragment,{children:t})},Ke=n(618),Le=n(363),Te=new Ke.QueryClient;function Ve(e){var t=e.children;return Object(z.jsx)(Le.QueryClientProvider,{client:Te,children:t})}var Ge=function(e){var t=e.children,n=Object(o.useState)(Fe);return Object(z.jsx)(Ve,{children:Object(z.jsx)(f.Provider,{value:n,children:Object(z.jsx)(Me,{children:t})})})},He=function(){return Object(z.jsx)(Ge,{children:Object(z.jsx)(Ee,{})})};c.default.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center"}});function Je(){return Object(z.jsx)(He,{})}Object(r.default)(Je),Object(r.default)(Je)}},[[427,1,2]]]);
//# sourceMappingURL=app.52a14ad3.chunk.js.map