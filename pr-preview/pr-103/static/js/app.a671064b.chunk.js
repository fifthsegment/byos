(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{332:function(e,t,n){e.exports=n(433)},353:function(e,t){},373:function(e,t){},433:function(e,t,n){"use strict";n.r(t);var r=n(475),i=(n(434),n(4)),o=n(1),c=n.n(o),a=n(5),l=n.n(a),s=n(7),u=n.n(s),d=n(15),f=n(6),j=n(465),b=n(464),p=n(41),O=n(77),h=n(477),g=n(84),x={s3credentials:{apiKey:void 0,apiSecret:void 0,region:void 0,endpoint:void 0,bucket:void 0},backblaze:{authorizationToken:"",downloadUrl:"",s3ApiUrl:""},s3client:void 0,otherStuff:"",mutatedAt:void 0},m=Object(o.createContext)(Object.create(null)),v=n(472),y=n(17),w=n.n(y),P=n(148),S=n(26),C=n.n(S),k=n(467),D=n(452),B=n(453),F=n(454),E=n(455),R=n(456),I=n(457),A=n(458),z=(n(340),n(352),n(432).getSignedUrl),M=function(e){var t=e.credentials,n=e.region,r=e.endpoint,i=new k.S3Client({region:n,credentials:t,endpoint:r,bucketEndpoint:!1,forcePathStyle:!0});return i.middlewareStack.add((function(e,t){return function(){var t=w()((function*(t){return yield e(t)}));return function(e){return t.apply(this,arguments)}}()}),{step:"finalizeRequest",name:"removeHeaders"}),i},N=function(){var e=w()((function*(e,t){var n,r,i=new D.ListObjectsCommand(t),o=yield e.send(i),c=(null==(n=o.CommonPrefixes)?void 0:n.map((function(e){return{prefix:e.Prefix,etag:void 0,name:e.Prefix,lastModified:void 0,size:0,key:e.Prefix}})))||[],a=(null==(r=o.Contents)?void 0:r.map((function(e){return{prefix:"",etag:e.ETag,name:null==e?void 0:e.Key,lastModified:null==e?void 0:e.LastModified,size:null==e?void 0:e.Size,key:e.Key}})))||[];return[].concat(C()(c),C()(a))}));return function(t,n){return e.apply(this,arguments)}}(),L=function(){var e=w()((function*(e,t){try{var n=yield e.send(new B.CopyObjectCommand(t));return console.log("updated asset",n),n}catch(r){console.log("Error",r)}}));return function(t,n){return e.apply(this,arguments)}}(),T=function(){var e=w()((function*(e,t){try{return yield e.send(new F.DeleteObjectCommand(t))}catch(n){console.log("Error",n)}}));return function(t,n){return e.apply(this,arguments)}}(),W=function(){var e=w()((function*(e,t){var n=new E.GetObjectCommand(t);return yield e.send(n)}));return function(t,n){return e.apply(this,arguments)}}(),K=function(){var e=w()((function*(e,t){var n=new E.GetObjectCommand(t);return yield z(e,n,{expiresIn:3600})}));return function(t,n){return e.apply(this,arguments)}}(),H=(function(){var e=w()((function*(e,t){var n=new E.GetObjectCommand(t),r=yield e.config.endpoint();n.middlewareStack.add((function(e){return function(){var e=w()((function*(e){var n=e.request,i=n.headers,o=n.path,c=r.hostname,a=r.protocol;return fetch(a+"//"+c+"/"+t.Bucket+o,{headers:i}).then((function(e){console.log("Response = ",e)})),new Promise((function(e,t){return t(new Error("Intentional Failure"))}))}));return function(t){return e.apply(this,arguments)}}()}),{step:"finalizeRequest",name:"rH"});try{yield e.send(n)}catch(i){}}))}(),function(){var e=w()((function*(e,t,n,r){var i={Key:t,Bucket:n};r&&(i.Body=r);var o=new R.PutObjectCommand(i);return yield e.send(o)}));return function(t,n,r,i){return e.apply(this,arguments)}}()),V=function(){var e=w()((function*(e,t,n){var r={Key:t,Bucket:n},i=new I.HeadObjectCommand(r);return yield e.send(i)}));return function(t,n,r){return e.apply(this,arguments)}}(),G=(function(){var e=w()((function*(e,t){t.CORSConfiguration.CORSRules.push({ID:"allaccess",AllowedHeaders:[""],AllowedMethods:[""],AllowedOrigins:[""],MaxAgeSeconds:3600,ExposeHeaders:["x-bz-content-sha1"]});var n=new A.PutBucketCorsCommand(t);return yield e.send(n)}))}(),n(315)),U=n(459),_=n(468),J=n(3),Y=i.default.create({textInput:{marginTop:20}}),q=function(e){var t=e.control,n=e.name,r=e.label;return void 0===t?null:Object(J.jsx)(J.Fragment,{children:Object(J.jsx)(P.Controller,{control:t,name:n,render:function(e){var t=e.field,i=t.value,o=t.onChange,c=t.onBlur;return Object(J.jsx)(J.Fragment,{children:Object(J.jsx)(_.default,{label:r,value:i,onChangeText:function(e){console.log("[InputChange] name = ",n," value = ",e),o(e)},onBlur:c,style:Y.textInput})})}})})},Q=n(179),$=n(276);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee=function(){var e=Object(o.useContext)(m),t=u()(e,2),n=t[0],r=t[1],a=n.s3credentials,l=Object(P.useForm)({defaultValues:a}),s=l.control,j=l.handleSubmit,b=l.getValues,O=l.reset;Object(o.useEffect)((function(){O(a)}),[a]);var h=Object(o.useState)(!1),g=u()(h,2)[1],x=function(){var e=w()((function*(){k();var e=b();r(Z(Z({},n),{},{s3credentials:e,s3client:void 0})),g(!0),setTimeout((function(){g(!1)}),1e3);var t=M({credentials:{accessKeyId:e.apiKey,secretAccessKey:e.apiSecret},region:e.region,endpoint:e.endpoint});N(t,{Bucket:"testinghumza"}).catch((function(){console.log("[SaveCredentialsForm] Promise failure getAssets")}))}));return function(){return e.apply(this,arguments)}}(),v=c.a.useState(!1),y=u()(v,2),S=y[0],C=y[1],k=function(){return C(!S)},D=i.default.create({container:{flex:1},inner:{padding:24,flex:1,justifyContent:"space-around"},header:{fontSize:36,marginBottom:48},textInput:{height:40,borderColor:"#000000",borderBottomWidth:1,marginBottom:36},snackBarContainer:{flex:1,justifyContent:"space-between"}});return Object(J.jsxs)($.default,{behavior:"ios"===d.default.OS?"padding":"height",style:D.container,children:[Object(J.jsxs)(G.default,{children:[Object(J.jsxs)(G.default.Content,{children:[Object(J.jsx)(p.default,{variant:"headlineSmall",children:"API Configuration"}),Object(J.jsx)(q,{control:s,name:"apiKey",label:"API KEY"}),Object(J.jsx)(q,{control:s,name:"apiSecret",label:"Api Secret"}),Object(J.jsx)(q,{control:s,name:"endpoint",label:"Endpoint"}),Object(J.jsx)(q,{control:s,name:"bucket",label:"Bucket"}),Object(J.jsx)(q,{control:s,name:"region",label:"Region"})]}),Object(J.jsx)(G.default.Actions,{children:Object(J.jsx)(Q.default,{onPress:j(x),children:"Submit"})})]}),Object(J.jsx)(f.default,{style:D.snackBarContainer,children:Object(J.jsx)(U.default,{visible:S,onDismiss:function(){return C(!1)},action:{label:"Dismiss",onPress:function(){}},children:"Credentials are saved!"})})]})},te=function(){return Object(J.jsx)(ee,{})},ne=n(463),re=n(473),ie=n(476),oe=n(460),ce=function(e,t){return e.map((function(e){var n,r=e.name.replace(t.Prefix,"");return{assetId:e.etag,fileName:r,fileSize:e.size,updatedAt:e.lastModified,isFolder:(null==(n=e.prefix)?void 0:n.length)>0,prefix:e.prefix,etag:e.etag,key:e.key}}))},ae=function(e){var t=e.s3credentials,n=t.apiKey,r=t.apiSecret,i=t.region,c=t.endpoint,a=Object(o.useMemo)((function(){return n&&r&&c?[M({region:i,credentials:{accessKeyId:n,secretAccessKey:r},endpoint:c}),!0]:[void 0,!1]}),[n,r,i,c]),l=u()(a,2);return[l[0],l[1]]},le=n(63),se=n(470),ue=n(158),de=n(72),fe=n(462),je=n(160),be=n(199),pe=n.n(be),Oe=n(285),he=n.n(Oe),ge=n(461),xe=function(){return Object(J.jsx)(J.Fragment,{})},me=function(e){switch(e){case"png":case"jpeg":case"jpg":return"image";default:return"file"}};pe.a.extend(he.a);var ve=i.default.create({icon:{},filename:{}}),ye=function(e){var t=e.isFolder?"folder":/(?:\.([^.]+))?$/.exec(e.fileName)[1]||"",n=e.fileName.split(".").pop();switch(t){case"folder":return Object(J.jsx)(ge.default,{name:"folder",color:"#ffbd43",size:22,style:ve.icon});default:return Object(J.jsx)(ge.default,{name:me(n),color:"#6565d6",size:22,style:ve.icon})}},we=function(){var e=Object(le.createColumnHelper)();return[e.accessor("fileName",{id:"fileName",header:"Name",cell:function(e){var t=e.row.original,n=t.isFolder?e.getValue().slice(0,-1):e.getValue();return Object(J.jsx)(J.Fragment,{children:Object(J.jsxs)(p.default,{variant:"bodyLarge",style:ve.filename,children:[ye(t)," \xa0",n]})})}}),e.accessor("fileSize",{id:"fileSize",header:"Size",cell:function(e){return Object(J.jsx)(p.default,{children:!e.row.original.isFolder&&Object(je.default)(e.getValue())})}}),e.accessor("updatedAt",{id:"updatedAt",header:"Last Modified",cell:function(e){return Object(J.jsx)(p.default,{children:!e.row.original.isFolder&&pe()(e.getValue()).fromNow()})}}),e.display({id:"actions",cell:function(){return Object(J.jsx)(xe,{})}})].filter((function(e){return"web"===d.default.OS||"fileName"===e.id}))},Pe=n(42),Se=function(e){return e<576?"xs":e>=576&&e<768?"md":e>=768&&e<992?"lg":e>=992&&e<1200?"xl":e>=1200?"xxl":void 0},Ce=Pe.default.get("window"),ke=Se(Ce.width),De=function(){var e=Object(o.useState)(ke),t=u()(e,2),n=t[0],r=t[1];return Object(o.useEffect)((function(){var e=Pe.default.addEventListener("change",(function(e){var t=e.window,n=(e.screen,Se(t.width));r(n)}));return function(){return null==e?void 0:e.remove()}}),[]),n},Be=i.default.create({tableHead:{height:"auto"},sorterIcon:{marginLeft:"10px"},cell:{flexBasis:"auto",paddingRight:"30px"},cellFirstChild:{flexBasis:"78%"},title:{display:"flex",alignItems:"center"}}),Fe=function(e){var t=e.assets,n=e.onPress,r=e.isLoading,i=c.a.useState((function(){return t||[]})),a=u()(i,2),l=a[0],s=a[1],d=c.a.useState([]),f=u()(d,2),j=f[0],b=f[1],O=Object(o.useState)(we()),h=u()(O,2),g=h[0],x=h[1],m=Object(o.useState)(1),v=u()(m,2),y=v[0],w=v[1],P=De();Object(o.useMemo)((function(){!function(){var e=Pe.default.get("window");return["xs"].includes(Se(e.width))}()?x(we()):x(we().filter((function(e){return"fileName"===e.id})))}),[P]),Object(o.useEffect)((function(){s(t||[]),w(1)}),[t]);var S=Object(le.useReactTable)({data:l,columns:g,state:{sorting:j},onSortingChange:b,getCoreRowModel:Object(le.getCoreRowModel)(),getSortedRowModel:Object(le.getSortedRowModel)(),getPaginationRowModel:Object(le.getPaginationRowModel)()});Object(o.useEffect)((function(){S.setPageSize(20*y)}),[y]);return Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(se.default.Header,{style:Be.tableHead,children:S.getHeaderGroups().map((function(e){return Object(J.jsx)(o.Fragment,{children:e.headers.map((function(e,t){var n;return Object(J.jsx)(se.default.Title,{style:0===t?Be.cellFirstChild:Be.cell,children:Object(J.jsx)(Q.default,{children:e.isPlaceholder?null:Object(J.jsxs)(p.default,{onClick:e.column.getToggleSortingHandler(),children:[Object(le.flexRender)(e.column.columnDef.header,e.getContext()),null!=(n={asc:Object(J.jsx)(fe.default,{name:"arrowup",style:Be.sorterIcon}),desc:Object(J.jsx)(fe.default,{name:"arrowdown",style:Be.sorterIcon})}[e.column.getIsSorted()])?n:null]})})},e.id)}))},e.id)}))}),Object(J.jsx)(de.default,{onScroll:function(e){(function(e){var t=e.layoutMeasurement,n=e.contentOffset,r=e.contentSize;return t.height+n.y>=r.height-20})(e.nativeEvent)&&(console.log("[Scroll] Scroll close to bottom"),w(y+1))},children:Object(J.jsxs)(se.default,{children:[r&&Object(J.jsx)(ue.default,{animating:!0}),S.getRowModel().rows.map((function(e){return Object(J.jsx)(se.default.Row,{onPress:function(){n(e.original)},children:e.getVisibleCells().map((function(e,t){return Object(J.jsx)(se.default.Cell,{style:0===t?Be.cellFirstChild:Be.cell,children:Object(le.flexRender)(e.column.columnDef.cell,e.getContext())},e.id)}))},e.id)})),Object(J.jsx)(se.default.Pagination,{page:S.getState().pagination.pageIndex+1,numberOfPages:S.getPageCount(),onPageChange:function(e){return S.setPageIndex(e-1)},label:S.getState().pagination.pageIndex+1+" of "+S.getPageCount()})]})})]})},Ee=n(317),Re=n(290),Ie=i.default.create({centeredView:{justifyContent:"center",alignItems:"center"},modalView:{backgroundColor:"white",borderRadius:20,padding:30,alignItems:"center"},button:{borderRadius:20,padding:10,elevation:2},buttonOpen:{backgroundColor:"#F194FF"},buttonClose:{backgroundColor:"#2196F3"},textStyle:{textAlign:"center"},modalText:{marginBottom:15,textAlign:"center"}}),Ae=function(e){var t=e.isVisible,n=e.onClose,r=e.children;return t?Object(J.jsx)(Ee.default,{children:Object(J.jsx)(Re.default,{visible:t,onDismiss:n,children:Object(J.jsx)(f.default,{style:Ie.centeredView,children:Object(J.jsx)(f.default,{style:Ie.modalView,children:r})})})}):null},ze=n(14),Me=n.n(ze),Ne=["children","isUnderlined"];function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var We=function(e){var t=e.children,n=e.isUnderlined,r=Me()(e,Ne);return Object(J.jsx)(p.default,Te(Te({},r),{},{style:n?[Ke.underline]:[],children:t}))},Ke=i.default.create({underline:{textDecorationLine:"underline"}}),He=Object(o.createContext)(Object.create({})),Ve=n(204),Ge=function(){var e=w()((function*(e){return(yield Object(Ve.default)({method:"GET",url:"https://api.backblazeb2.com/b2api/v2/b2_authorize_account",headers:{Accept:"application/json",Authorization:"Basic "+e}})).data}));return function(t){return e.apply(this,arguments)}}(),Ue=(function(){var e=w()((function*(e,t,n){return(yield Object(Ve.default)({method:"POST",url:"https://api.backblazeb2.com/b2api/v2/b2_get_download_authorization",headers:{Accept:"application/json",Authorization:"Basic "+e},data:{bucketId:t,fileNamePrefix:n,validDurationInSeconds:86400}})).data}))}(),function(){var e=w()((function*(e){var t=e.s3credentials,n=t.apiKey,r=t.apiSecret,i=btoa(n+":"+r);return yield Ge(i)}))}(),function(){var e=w()((function*(e,t,n,r){return e.s3credentials.endpoint.toLowerCase().includes("backblazeb2")?yield K(n,{Key:r,Bucket:e.s3credentials.bucket}):yield K(e.s3client,{Key:r,Bucket:e.s3credentials.bucket})}));return function(t,n,r,i){return e.apply(this,arguments)}}());function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ye=function(e){var t=e.asset,n=e.onClose,r=(e.prefix,Object(o.useContext)(m)),i=u()(r,2),c=i[0],a=i[1],l=c.s3credentials,s=Object(o.useContext)(He),d=u()(s,1)[0],j=Object(o.useState)(!1),b=u()(j,2),h=b[0],g=b[1],x=Object(o.useState)(t),v=u()(x,2),y=v[0],P=v[1],S=Object(o.useState)(t.fileName),C=u()(S,2),k=C[0],D=C[1],B=ae(c),F=u()(B,1)[0],E=De(),R=function(){var e=w()((function*(){g(!1),P((function(e){return Je(Je({},e),{},{fileName:k})})),yield L(F,{Bucket:l.bucket,Key:t.key.replace(t.fileName,k),CopySource:l.bucket+"/"+t.key}),yield T(F,{Key:t.key,Bucket:l.bucket}),a(Je(Je({},c),{},{mutatedAt:new Date}))}));return function(){return e.apply(this,arguments)}}(),I=function(){var e=w()((function*(){var e={Bucket:l.bucket,Key:y.key};yield T(F,e),a(Je(Je({},c),{},{mutatedAt:new Date}))}));return function(){return e.apply(this,arguments)}}(),A=function(){var e=w()((function*(){var e=yield Ue(c,a,F,t.key),n=document.createElement("a");n.href=e,n.download=t.key,n.style.display="none",document.body.appendChild(n),n.click(),n.remove()}));return function(){return e.apply(this,arguments)}}();return Object(J.jsx)(J.Fragment,{children:Object(J.jsxs)(f.default,{style:["xs","md"].includes(E)?[qe.mainMobile]:[qe.main],children:[Object(J.jsx)(O.default,{theme:d,icon:"close",onPress:n,style:qe.closeButton}),Object(J.jsxs)(f.default,{style:["xs","md"].includes(E)?[qe.section2Mobile,qe.centered]:[qe.section2,qe.centered],children:[Object(J.jsx)(p.default,{variant:"headlineSmall",style:[qe.textCenter,qe.marginBottom],children:Object(J.jsx)(ge.default,{theme:d,name:"file",size:100})}),Object(J.jsx)(p.default,{variant:"headlineSmall",style:qe.textCenter,children:h?Object(J.jsx)(_.default,{value:h?k:null==y?void 0:y.fileName,onChangeText:function(e){return D(e)}}):null==y?void 0:y.fileName}),Object(J.jsx)(p.default,{children:Object(je.default)(t.fileSize)}),Object(J.jsxs)(f.default,{style:[qe.centered,qe.horizontal],children:[h?Object(J.jsx)(O.default,{theme:d,icon:"check",onPress:R}):Object(J.jsx)(O.default,{theme:d,icon:"pencil",onPress:function(){return g(!0)}}),Object(J.jsx)(O.default,{theme:d,icon:"trash-can",onPress:I}),Object(J.jsx)(O.default,{theme:d,icon:"download",onPress:A})]})]})]})})},qe=i.default.create({mainMobile:{backgroundColor:"rgb(242, 242, 242)"},main:{display:"flex",flexGrow:1},closeButton:{display:"flex",textAlign:"right",height:50},marginBottom:{marginBottom:10},textCenter:{textAlign:"center"},centered:{justifyContent:"center",alignItems:"center"},horizontal:{flexDirection:"row"},section2:{minWidth:"30vw",flex:1,flexGrow:1,margin:20},section2Mobile:{backgroundColor:"rgb(242, 242, 242)",minWidth:"100vw",flex:1,flexGrow:1,margin:20}}),Qe=n(176),$e=n(58),Xe=n(167),Ze=["png","jpeg","jpg"],et=function(e){var t=e.item,n=e.onPress,r=e.s3client,i=e.s3Initialized,c=e.appState,a=Object(o.useState)(),l=u()(a,2),s=l[0],d=l[1],f=Object(o.useState)(void 0),j=u()(f,2),b=j[0],O=j[1],h=Object(o.useState)(!1),g=u()(h,2),x=g[0],m=g[1],v=Object(o.useState)(!1),y=u()(v,2)[1],w=t.fileName.split(".").pop(),P=Ze.includes(w),S=t.isFolder?"folder":me(w),C=t.fileSize<1e6;Object(o.useEffect)((function(){t.isFolder||P&&C&&(y(!0),W(r,{Key:t.key,Bucket:c.s3credentials.bucket}).then((function(e){var t;(t=e.Body,new Response(t,{})).blob().then((function(e){var t=new FileReader;t.readAsDataURL(e),t.onload=function(){var e=t.result;d(e),m(!0)}})).catch((function(e){O(e)}))})).catch((function(e){O(e)})))}),[i]);return Object(J.jsxs)(Xe.default,{onPress:function(){n(t)},children:[P&&C?x&&!b?Object(J.jsx)($e.default,{source:{uri:s.toString()},style:tt.preview}):Object(J.jsx)(ge.default,{name:"alert-triangle",size:100,style:tt.errorIcon}):Object(J.jsx)(ge.default,{name:S,size:100,style:tt.icon}),Object(J.jsx)(p.default,{style:tt.fileName,onPress:function(){n(t)},children:t.fileName})]})},tt=i.default.create({preview:{width:"100%",height:200},icon:{marginTop:20},wrapper:{},fileName:{bottom:0,textAlign:"center"},errorIcon:{color:"red"}}),nt=function(e){var t=e.item,n=e.onPress,r=t.fileName.split(".").pop(),i=t.isFolder?"folder":me(r);return Object(J.jsxs)(Xe.default,{onPress:function(){n(t)},children:[Object(J.jsx)(ge.default,{name:i,size:100,style:rt.icon}),Object(J.jsx)(p.default,{style:rt.fileName,onPress:function(){n(t)},children:t.fileName})]})},rt=i.default.create({icon:{marginTop:20},wrapper:{},fileName:{bottom:0,textAlign:"center"},errorIcon:{color:"red"}}),it=function(e){var t=e.item,n=e.onPress,r=e.s3client,i=e.s3Initialized,o=e.appState,c=t.fileName.split(".").pop();return Object(J.jsx)(f.default,{style:ot.item,children:function(){switch(c){case"png":case"jpeg":case"jpg":return Object(J.jsx)(et,{item:t,onPress:n,s3client:r,s3Initialized:i,appState:o});default:return Object(J.jsx)(nt,{item:t,onPress:n})}}()})},ot=i.default.create({item:{marginVertical:8,marginHorizontal:16,height:200,display:"flex",flex:1,overflow:"hidden",textAlign:"center"}}),ct=i.default.create({cell:{flexBasis:"auto",minWidth:"105px",paddingRight:"15px"},cellFirstChild:{flexBasis:"78%"},title:{display:"flex",alignItems:"center"},columnWrapperStyle:{display:"flex"}}),at=function(e){var t=e.assets,n=e.onPress,r=e.isLoading,i=Object(o.useContext)(m),a=u()(i,1)[0],l=ae(a),s=u()(l,2),d=s[0],j=s[1],b=c.a.useState((function(){return t||[]})),p=u()(b,2),O=p[0],h=p[1],g=Object(o.useState)(1),x=u()(g,2),v=x[0],y=x[1],w=Object(o.useState)(4),P=u()(w,2),S=P[0],C=P[1],k=De();Object(o.useMemo)((function(){["xs","md"].includes(k)?C(3):C(4)}),[k]),Object(o.useEffect)((function(){h(t||[]),y(1)}),[t]);var D=Object(le.useReactTable)({data:O,columns:lt(),getCoreRowModel:Object(le.getCoreRowModel)(),getPaginationRowModel:Object(le.getPaginationRowModel)()}),B=D.getRowModel().flatRows.map((function(e){return e.original}));Object(o.useEffect)((function(){D.setPageSize(20*v)}),[v]);return Object(J.jsx)(J.Fragment,{children:Object(J.jsxs)(de.default,{onScroll:function(e){(function(e){var t=e.layoutMeasurement,n=e.contentOffset,r=e.contentSize;return t.height+n.y>=r.height-20})(e.nativeEvent)&&(console.log("[Scroll] Scroll close to bottom"),y(v+1))},children:[r&&Object(J.jsx)(ue.default,{animating:!0}),Object(J.jsxs)(f.default,{children:[Object(J.jsx)(Qe.default,{columnWrapperStyle:ct.columnWrapperStyle,numColumns:S,data:B,renderItem:function(e){var t=e.item;return Object(J.jsx)(it,{item:t,onPress:n,s3client:d,s3Initialized:j,appState:a})},keyExtractor:function(e){return e.fileName}},"flatlistassets-"+S),Object(J.jsx)(J.Fragment,{})]})]})})},lt=function(){return[Object(le.createColumnHelper)().accessor("fileName",{id:"fileName",header:"Name",cell:function(e){return Object(J.jsx)(J.Fragment,{})}})]},st=n(320),ut=n(471),dt=i.default.create({dialog:{width:250,left:"39%"}}),ft=function(e){var t,n=e.filesOverwrite,r=e.porcessingOverwrite,i=e.setProcessingOverwrite,a=e.setFilesOverwrite,l=e.s3credentials,s=e.s3client,d=c.a.useState(!1),f=u()(d,2),j=f[0],b=f[1];return Object(o.useEffect)((function(){if(0===n.length)b(!1);else{var e=n[0];i(e),b(!0)}}),[n]),Object(J.jsx)(J.Fragment,{children:Object(J.jsx)(Ee.default,{children:Object(J.jsxs)(ut.default,{visible:j,style:dt.dialog,dismissable:!1,children:[Object(J.jsx)(ut.default.Title,{children:"Alert"}),Object(J.jsx)(ut.default.Content,{children:Object(J.jsx)(p.default,{children:Object(J.jsxs)(J.Fragment,{children:['File "',null==r||null==(t=r.file)?void 0:t.name,'" already exists, do you want to overwrite']})})}),Object(J.jsxs)(ut.default.Actions,{children:[Object(J.jsx)(Q.default,{onPress:function(){a((function(e){return e.filter((function(e){return e!=r}))}))},children:"Skip"}),Object(J.jsx)(Q.default,{onPress:function(){var e=H(s,r.file.name,l.bucket,r.file);e.then((function(){})),e.catch((function(){})),a((function(e){return e.filter((function(e){return e!=r}))}))},children:"Yes"})]})]})})})},jt=i.default.create({snackbarcontainer:{left:"-45%"},snackbarinner:{backgroundColor:"grey",width:250,height:50},snackbartext:{color:"white"},uploadcontainer:{padding:10,flexDirection:"row"},activityindicator:{marginLeft:5},dialog:{width:250,left:"39%"}}),bt=function(e){var t=e.appState,n=e.s3client,r=e.prefix,i=e.doReload,a=e.doCloseModal,l=t.s3credentials,s=Object(o.useState)(!1),j=u()(s,2),b=j[0],h=j[1],g=Object(o.useState)(!0),x=u()(g,2),m=x[0],v=x[1],y=c.a.useState([]),P=u()(y,2),S=P[0],k=P[1],D=c.a.useState({overwrite:!1,file:null}),B=u()(D,2),F=B[0],E=B[1],R=c.a.useState(!1),I=u()(R,2),A=I[0],z=I[1],M=function(){return z(!A)};return Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(ft,{filesOverwrite:S,porcessingOverwrite:F,setProcessingOverwrite:E,setFilesOverwrite:k,s3credentials:l,s3client:n}),Object(J.jsxs)(p.default,{children:["Upload location : ",r]}),Object(J.jsxs)(f.default,{style:jt.uploadcontainer,children:[b&&"Uploading",Object(J.jsx)(O.default,{icon:"cloud-upload",onPress:w()((function*(){var e=yield st.getDocumentAsync({multiple:!0});h(!0);var t=null==e?void 0:e.output;if("ios"===d.default.OS){var o=yield fetch(e.uri);t=[yield o.blob()]}var c=function(e){var t=V(n,r+e.name,l.bucket);console.log(t),t.then((function(t){k((function(t){return[].concat(C()(t),[{overwrite:!1,file:e}])}))})),t.catch((function(){var t=H(n,r+e.name,l.bucket,e);t.then((function(){v(!1),M(),i(),a()})),t.catch((function(){M()}))}))};for(var s of t)c(s)}))})]}),Object(J.jsx)(f.default,{style:jt.snackbarcontainer,children:Object(J.jsx)(U.default,{style:jt.snackbarinner,visible:A,onDismiss:function(){z(!1),h(!1)},action:{label:"Dismiss",onPress:function(){}},children:m?Object(J.jsx)(p.default,{style:jt.snackbartext,children:"Failed to upload file"}):Object(J.jsx)(p.default,{style:jt.snackbartext,children:"File upload successfull"})})})]})},pt=function(e){var t=e.appState,n=e.s3client,r=e.prefix,i=e.doReload,o=e.doCloseModal,a=c.a.useState(""),l=u()(a,2),s=l[0],d=l[1],j=function(){var e=w()((function*(){var e=s;yield H(n,r+e+"/",t.s3credentials.bucket),i(),o()}));return function(){return e.apply(this,arguments)}}();return Object(J.jsxs)(f.default,{children:[Object(J.jsx)(p.default,{children:"Create Folder"}),Object(J.jsx)(_.default,{label:"Name",value:s,onChangeText:function(e){return d(e)}}),Object(J.jsx)(Q.default,{icon:"folder",mode:"contained",style:Ot.ButtonWrapper,onPress:function(){j().catch((function(e){console.log("[CreateFolder] Exception = ",e)}))},children:"Save"})]})},Ot=i.default.create({ButtonWrapper:{marginTop:"10px"}});function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xt=function(){var e,t,n=Object(o.useState)(void 0),r=u()(n,2),i=r[0],a=r[1],l=c.a.useState(!1),s=u()(l,2),d=s[0],j=s[1],b=c.a.useState(!1),h=u()(b,2),x=h[0],v=h[1],y=c.a.useState(!1),P=u()(y,2),S=P[0],k=P[1],D=Object(o.useState)(""),B=u()(D,2),F=B[0],E=B[1],R=Object(o.useContext)(m),I=u()(R,1)[0],A=ae(I),z=u()(A,2),M=z[0],L=z[1],T=c.a.useState(!0),W=u()(T,2),K=W[0],H=W[1],V=Object(o.useState)({Bucket:I.s3credentials.bucket,Prefix:"",Delimiter:"/"}),U=u()(V,2),_=U[0],Y=U[1];Object(o.useEffect)((function(){Y(gt(gt({},_),{},{Bucket:I.s3credentials.bucket}))}),[I,M]);var q=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4?arguments[4]:void 0,o=Object(oe.useQuery)(["getAssets",r,n.Bucket||"",n.Delimiter||"",n.Prefix||"",i||""],w()((function*(){try{var t=yield N(e,n);return ce(t,n)}catch(r){console.log("[useGetAssets] Error : ",r)}return[]})),{enabled:t,refetchOnWindowFocus:!1});return o}(M,L,_,F,I.mutatedAt),Q=q.data,$=q.isLoading,X=q.isError,Z=function(e){Y(gt(gt({},_),{},{Prefix:e}))},ee=function(e){e.isFolder?Z(e.prefix):a(e)},te=["bucket"].concat(C()(null==(e=_.Prefix)?void 0:e.split("/"))),le=te.map((function(e,t){var n=t===(null==te?void 0:te.length)-1;return Object(J.jsxs)(We,{isUnderlined:!n,onPress:function(){!function(e){var t,n=(null==(t=_.Prefix)?void 0:t.split("/")).slice(0,e).join("/")+"/";Z("/"===n?"":n)}(t)},children:["/",!n&&Object(J.jsx)(ne.default,{name:"folder-open-outline",color:"#ffbd43",size:22}),e]},"dirPath"+t)})),se=function(){E(""+Math.random())};return Object(J.jsx)(J.Fragment,{children:L?Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(g.Portal,{hostName:"Reloader",children:Object(J.jsx)(O.default,{animated:!0,icon:"reload",onPress:function(){se()}})}),Object(J.jsx)(g.Portal,{hostName:"Back",children:(null==(t=_.Prefix)?void 0:t.length)>0&&Object(J.jsx)(O.default,{icon:"arrow-left",onPress:function(){!function(){var e=_.Prefix;if(""!==e){var t=e.substring(0,e.substring(0,e.length-1).lastIndexOf("/")+1);Z(t)}}()}})}),Object(J.jsxs)(f.default,{style:mt.root,children:[Object(J.jsxs)(f.default,{style:mt.section1,children:[X&&Object(J.jsx)(p.default,{variant:"headlineSmall",children:"Error "}),Object(J.jsxs)(f.default,{style:mt.actionBarContainer,children:[Object(J.jsx)(p.default,{variant:"bodyMedium",style:mt.path,children:le}),Object(J.jsxs)(f.default,{style:mt.buttonGroup,children:[Object(J.jsx)(re.default,{icon:"dots-grid",value:"grid",status:!1===K?"checked":"unchecked",onPress:function(){return H(!1)}}),Object(J.jsx)(re.default,{icon:"table",value:"table",status:!0===K?"checked":"unchecked",onPress:function(){return H(!0)}})]})]}),Object(J.jsx)(Ae,{isVisible:x,onClose:function(){v(!1)},children:Object(J.jsx)(bt,{appState:I,s3client:M,prefix:_.Prefix,doReload:se,doCloseModal:function(){v(!1)}})}),Object(J.jsx)(Ae,{isVisible:S,onClose:function(){k(!1)},children:Object(J.jsx)(pt,{appState:I,s3client:M,prefix:_.Prefix,doReload:se,doCloseModal:function(){k(!1)}})}),K?Object(J.jsx)(Fe,{assets:Q,onPress:ee,isLoading:$}):Object(J.jsx)(at,{assets:Q,onPress:ee,isLoading:$}),Object(J.jsx)(ie.default.Group,{backdropColor:"none",icon:"plus",onStateChange:function(e){var t=e.open;j(t)},open:d,onPress:function(){return j(!d)},visible:!0,style:[mt.fabStyle],actions:[{icon:"plus",label:"Upload",onPress:function(){return v(!0)}},{icon:"folder",label:"New Folder",onPress:function(){return k(!0)}}]})]}),i&&Object(J.jsx)(Ye,{prefix:_.Prefix,onClose:function(){return a(void 0)},asset:i})]})]}):Object(J.jsx)(G.default,{style:mt.errorMessage,children:Object(J.jsx)(p.default,{children:"S3 Client has not been initialized, please update your API Configuration first."})})})},mt=i.default.create({path:{display:"flex",margin:10,flex:1},fabStyle:{bottom:45,right:25,position:"absolute"},errorMessage:{margin:12,padding:10},root:{flexDirection:"row",display:"flex",flex:1,flexGrow:1},section1:{flex:3,borderColor:"gray",borderRightWidth:2,flexDirection:"column"},buttonGroup:{display:"flex",flexDirection:"row"},actionBarContainer:{display:"flex",flexDirection:"row"}});function vt(){return Object(J.jsx)(xt,{})}var yt=n(469),wt=function(e){return Object(J.jsxs)(yt.default.Header,{mode:"center-aligned",elevated:!0,children:[Object(J.jsx)(g.PortalHost,{name:"Back"}),Object(J.jsx)(yt.default.Content,{title:e.title}),Object(J.jsx)(g.PortalHost,{name:"Reloader"})]})},Pt=function(){var e=o.useState(0),t=u()(e,2),n=t[0],r=t[1],i=o.useState([{key:"assets",title:"Assets",focusedIcon:"folder"},{key:"api_configuration",title:"API Configuration",focusedIcon:"cogs"}]),c=u()(i,1)[0],a=v.default.SceneMap({assets:vt,api_configuration:te});return"web"===d.default.OS?null:Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(wt,{title:"BYOS"}),Object(J.jsx)(v.default,{navigationState:{index:n,routes:c},onIndexChange:r,renderScene:a})]})},St=n(206),Ct=function(){var e=w()((function*(e){try{yield St.default.setItem("byos/application",JSON.stringify(e))}catch(t){}}));return function(t){return e.apply(this,arguments)}}(),kt=function(){var e=w()((function*(){try{var e=yield St.default.getItem("byos/application");if(null!==e)return e}catch(t){}return""}));return function(){return e.apply(this,arguments)}}(),Dt=function(e){try{return JSON.parse(e)}catch(t){return{}}},Bt=function(){var e=w()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"{}",t=yield kt();return Dt(t||e)}));return function(){return e.apply(this,arguments)}}(),Ft=function(){var e=w()((function*(e){return yield Ct(e),null}));return function(t){return e.apply(this,arguments)}}();function Et(){return Object(J.jsx)(J.Fragment,{children:Object(J.jsx)(ee,{})})}var Rt=n(183);function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function At(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zt=At(At({},Rt.MD3LightTheme),{},{roundness:2,version:3,colors:At({},Rt.MD3LightTheme.colors)}),Mt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Nt(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Tt=Object(b.default)(),Wt=i.default.create({ButtonsWrapper:{flexDirection:"row"},Button:{border:"1px",borderStyle:"solid"}});var Kt=function(e){var t=e.children,n=Object(o.useContext)(He),r=u()(n,1)[0];return Object(J.jsx)(h.default,{theme:r,children:t})},Ht=function(){var e=Object(o.useState)(zt),t=function(e){var t=Object(o.useState)(e),n=u()(t,2),r=n[0],i=n[1],c=Object(o.useState)(!1),a=u()(c,2),l=a[0],s=a[1];return Object(o.useMemo)((function(){Bt(JSON.stringify(e)).then((function(e){i(e),s(!0)})).catch((function(){console.log("[useGetApplicationStateFromLs] Promise failure getApplicationStateLS")}))}),[e]),{data:r,isLoaded:l}}(x),n=t.data,r=t.isLoaded,i=Object(o.useState)(n),c=u()(i,2),a=c[0],s=c[1];Object(o.useEffect)((function(){s(n)}),[n]),Object(o.useEffect)((function(){r&&Ft(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},a))}),[a,r]);var b=function(e){var t=e.navigation;return{headerTitle:function(e){return Object(J.jsx)(p.default,{children:"BYOS"})},headerRight:function(){return Object(J.jsxs)(f.default,{style:Wt.ButtonsWrapper,children:[Object(J.jsx)(g.PortalHost,{name:"Reloader"}),Object(J.jsx)(O.default,{style:Wt.Button,icon:"home",onPress:function(){return t.navigate("Home")}}),Object(J.jsx)(O.default,{style:Wt.Button,icon:"cogs",onPress:function(){return t.navigate("Credentials")}})]})}}};return Object(J.jsx)(He.Provider,{value:e,children:Object(J.jsx)(Kt,{children:Object(J.jsx)(g.PortalProvider,{children:Object(J.jsxs)(m.Provider,{value:i,children:["web"===d.default.OS&&Object(J.jsx)(j.default,{children:Object(J.jsxs)(Tt.Navigator,{children:[Object(J.jsx)(Tt.Screen,{name:"Home",component:vt,options:b}),Object(J.jsx)(Tt.Screen,{name:"Credentials",component:Et,options:b})]})}),Object(J.jsx)(Pt,{})]})})})})};!function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="./service-worker.js";Mt?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Nt(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Nt(t,e)}))}}();var Vt=Object(o.createContext)(Object.create(null));var Gt={isReady:!1,routes:[{path:"/credentials",component:Object(J.jsx)(Et,{}),showInNavigation:!0},{path:"/",component:Object(J.jsx)((function(){return Object(J.jsx)(J.Fragment,{})}),{}),showInNavigation:!0}]};function Ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ut(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Jt=function(e){var t=e.children,n=c.a.useContext(Vt),r=u()(n,2),i=r[0],a=r[1];return Object(o.useEffect)((function(){!1===i.isReady&&a(_t(_t({},i),{},{isReady:!0}))}),[i.isReady,i.routes]),Object(J.jsx)(J.Fragment,{children:t})},Yt=n(466),qt=n(279),Qt=new Yt.QueryClient;function $t(e){var t=e.children;return Object(J.jsx)(qt.QueryClientProvider,{client:Qt,children:t})}var Xt=function(e){var t=e.children,n=Object(o.useState)(Gt);return Object(J.jsx)($t,{children:Object(J.jsx)(Vt.Provider,{value:n,children:Object(J.jsx)(Jt,{children:t})})})},Zt=function(){return Object(J.jsx)(Xt,{children:Object(J.jsx)(Ht,{})})};i.default.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center"}});function en(){return Object(J.jsx)(Zt,{})}Object(r.default)(en),Object(r.default)(en)}},[[332,1,2]]]);
//# sourceMappingURL=app.a671064b.chunk.js.map