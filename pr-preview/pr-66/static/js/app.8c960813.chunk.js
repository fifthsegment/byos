(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{267:function(e,t,n){e.exports=n(358)},345:function(e,t){},358:function(e,t,n){"use strict";n.r(t);var r=n(383),i=(n(359),n(3)),o=n(1),c=n.n(o),a=n(7),l=n.n(a),s=n(23),u=n.n(s),d=Object(o.createContext)(Object.create(null)),f={s3credentials:{apiKey:void 0,apiSecret:void 0,region:void 0,endpoint:void 0,bucket:void 0},s3client:void 0,otherStuff:""},j=Object(o.createContext)(Object.create(null)),b=n(385),O=n(379),g=n(77),p=n(4),h=function(e){return Object(p.jsxs)(O.default.Header,{mode:"center-aligned",elevated:!0,children:[Object(p.jsx)(g.PortalHost,{name:"Back"}),Object(p.jsx)(O.default.Content,{title:e.title}),Object(p.jsx)(g.PortalHost,{name:"Reloader"})]})},x=n(381),m=n(133),y=n(39),v=n.n(y),P=n(29),w=n.n(P),S=n(377),C=n(372),k=(n(313),n(325),function(e){var t=e.credentials,n=e.region,r=e.endpoint,i=new S.S3Client({region:n,credentials:t,endpoint:r});return i.middlewareStack.add((function(e,t){return function(){var t=w()((function*(t){return yield e(t)}));return function(e){return t.apply(this,arguments)}}()}),{step:"finalizeRequest",name:"removeHeaders"}),i}),D=function(){var e=w()((function*(e,t){var n,r;console.log("[s3:getAssets] Making a List Objects command");var i=new C.ListObjectsCommand(t);console.log("[s3:getAssets] Command ",i),console.log("[s3:getAssets] Our s3 Client",e),console.log("[s3:getAssets] Sending command using client.send");var o=yield e.send(i),c=(null==(n=o.CommonPrefixes)?void 0:n.map((function(e){return{prefix:e.Prefix,etag:void 0,name:e.Prefix,lastModified:void 0,size:0}})))||[],a=(null==(r=o.Contents)?void 0:r.map((function(e){return{prefix:"",etag:e.ETag,name:null==e?void 0:e.Key,lastModified:null==e?void 0:e.LastModified,size:null==e?void 0:e.Size}})))||[];return[].concat(v()(c),v()(a))}));return function(t,n){return e.apply(this,arguments)}}(),A=n(253),F=n(37),I=n(373),E=n(378),R=i.default.create({textInput:{marginTop:20}}),B=function(e){var t=e.control,n=e.name,r=e.label;return void 0===t?null:Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(m.Controller,{control:t,name:n,render:function(e){var t=e.field,i=t.value,o=t.onChange,c=t.onBlur;return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(E.default,{label:r,value:i,onChangeText:function(e){console.log("[InputChange] name = ",n," value = ",e),o(e)},onBlur:c,style:R.textInput})})}})})},M=n(138),z=n(230),L=n(15),V=n(5);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(){var e=Object(o.useContext)(j),t=u()(e,2),n=t[0],r=t[1],a=n.s3credentials,l=Object(m.useForm)({defaultValues:a}),s=l.control,d=l.handleSubmit,f=l.getValues,b=l.reset;Object(o.useEffect)((function(){b(a)}),[a]);var O=Object(o.useState)(!1),g=u()(O,2)[1],h=c.a.useState(!1),x=u()(h,2),y=x[0],v=x[1],P=function(){return v(!y)},w=i.default.create({container:{flex:1},inner:{padding:24,flex:1,justifyContent:"space-around"},header:{fontSize:36,marginBottom:48},textInput:{height:40,borderColor:"#000000",borderBottomWidth:1,marginBottom:36},snackBarContainer:{flex:1,justifyContent:"space-between"}});return Object(p.jsxs)(z.default,{behavior:"ios"===L.default.OS?"padding":"height",style:w.container,children:[Object(p.jsxs)(A.default,{children:[Object(p.jsxs)(A.default.Content,{children:[Object(p.jsx)(F.default,{variant:"headlineSmall",children:"API Configuration"}),Object(p.jsx)(B,{control:s,name:"apiKey",label:"API KEY"}),Object(p.jsx)(B,{control:s,name:"apiSecret",label:"Api Secret"}),Object(p.jsx)(B,{control:s,name:"endpoint",label:"Endpoint"}),Object(p.jsx)(B,{control:s,name:"bucket",label:"Bucket"}),Object(p.jsx)(B,{control:s,name:"region",label:"Region"})]}),Object(p.jsx)(A.default.Actions,{children:Object(p.jsx)(M.default,{onPress:d((function(){console.log("Submitting form"),P();var e=f();r(T(T({},n),{},{s3credentials:e,s3client:void 0})),g(!0),setTimeout((function(){g(!1)}),1e3);var t=k({credentials:{accessKeyId:e.apiKey,secretAccessKey:e.apiSecret},region:e.region,endpoint:e.endpoint});D(t,{Bucket:"testinghumza"}).catch((function(){console.log("[SaveCredentialsForm] Promise failure getAssets")}))})),children:"Submit"})})]}),Object(p.jsx)(V.default,{style:w.snackBarContainer,children:Object(p.jsx)(I.default,{visible:y,onDismiss:function(){return v(!1)},action:{label:"Dismiss",onPress:function(){}},children:"Credentials are saved!"})})]})},G=function(){return Object(p.jsx)(K,{})},H=n(74),J=n(134),W=n(384),Q=n(374),q=function(e,t){return e.map((function(e){var n,r=e.name.replace(t.Prefix,"");return{assetId:e.etag,fileName:r,fileSize:e.size,updatedAt:e.lastModified,isFolder:(null==(n=e.prefix)?void 0:n.length)>0,prefix:e.prefix}}))},Y=n(79),_=n(380),U=n(71),$=function(){return Object(p.jsx)(p.Fragment,{})},X=n(240),Z=n(160),ee=n.n(Z),te=n(241),ne=n.n(te),re=n(375);ee.a.extend(ne.a);var ie=i.default.create({icon:{},filename:{}}),oe=function(e){switch(e.isFolder?"folder":/(?:\.([^.]+))?$/.exec(e.fileName)[1]||""){case"folder":return Object(p.jsx)(re.default,{name:"folder",color:"#ffbd43",size:22,style:ie.icon});case"txt":return Object(p.jsx)(re.default,{name:"file-text",color:"#6565d6",size:22,style:ie.icon});default:return Object(p.jsx)(re.default,{name:"file",color:"#6565d6",size:22,style:ie.icon})}},ce=function(){var e=Object(Y.createColumnHelper)();return[e.accessor("fileName",{id:"fileName",header:"Name",cell:function(e){var t=e.row.original,n=t.isFolder?e.getValue().slice(0,-1):e.getValue();return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(F.default,{variant:"bodyLarge",style:ie.filename,children:[oe(t)," \xa0",n]})})}}),e.accessor("fileSize",{id:"fileSize",header:"Size",cell:function(e){return Object(p.jsx)(F.default,{children:!e.row.original.isFolder&&Object(X.default)(e.getValue())})}}),e.accessor("updatedAt",{id:"updatedAt",header:"Last Modified",cell:function(e){return Object(p.jsx)(F.default,{children:!e.row.original.isFolder&&ee()(e.getValue()).fromNow()})}}),e.display({id:"actions",cell:function(){return Object(p.jsx)($,{})}})].filter((function(e){return"web"===L.default.OS||"fileName"===e.id}))},ae=i.default.create({cell:{flexBasis:"auto",paddingRight:"30px"},cellFirstChild:{flexBasis:"78%"},title:{display:"flex",alignItems:"center"}}),le=function(e){var t=e.assets,n=e.onPress,r=c.a.useState((function(){return t||[]})),i=u()(r,2),a=i[0],l=i[1];Object(o.useEffect)((function(){l(t||[])}),[t]);var s=Object(Y.useReactTable)({data:a,columns:ce(),getCoreRowModel:Object(Y.getCoreRowModel)(),getPaginationRowModel:Object(Y.getPaginationRowModel)()});return Object(o.useEffect)((function(){s.setPageSize(20)}),[]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(_.default.Header,{children:s.getHeaderGroups().map((function(e){return Object(p.jsx)(o.Fragment,{children:e.headers.map((function(e,t){return Object(p.jsx)(_.default.Title,{style:0===t?ae.cellFirstChild:ae.cell,children:Object(p.jsx)(F.default,{children:e.isPlaceholder?null:Object(Y.flexRender)(e.column.columnDef.header,e.getContext())})},e.id)}))},e.id)}))}),Object(p.jsx)(U.default,{children:Object(p.jsxs)(_.default,{children:[s.getRowModel().rows.map((function(e){return Object(p.jsx)(_.default.Row,{onPress:function(){n(e.original)},children:e.getVisibleCells().map((function(e,t){return Object(p.jsx)(_.default.Cell,{style:0===t?ae.cellFirstChild:ae.cell,children:Object(Y.flexRender)(e.column.columnDef.cell,e.getContext())},e.id)}))},e.id)})),Object(p.jsx)(_.default.Pagination,{page:s.getState().pagination.pageIndex+1,numberOfPages:s.getPageCount(),onPageChange:function(e){return s.setPageIndex(e-1)},label:s.getState().pagination.pageIndex+1+" of "+s.getPageCount()})]})})]})},se=n(36),ue=n(41),de=function(e){return e<576?"xs":e>=576&&e<768?"md":e>=768&&e<992?"lg":e>=992&&e<1200?"xl":e>=1400?"xxl":void 0},fe=ue.default.get("window"),je=ue.default.get("screen"),be=de(fe.width),Oe=function(e){var t=e.hidden,n=e.children,r=Object(o.useState)({window:fe,screen:je,screenType:be}),i=u()(r,2),c=i[0],a=i[1];Object(o.useEffect)((function(){var e=ue.default.addEventListener("change",(function(e){var t=e.window,n=e.screen,r=de(t.width);a({window:t,screen:n,screenType:r})}));return function(){return null==e?void 0:e.remove()}}),[]);var l=!!t&&t.includes(c.screenType);return Object(p.jsx)(p.Fragment,{children:!l&&Object(p.jsx)(V.default,{children:n})})},ge=(i.default.create({header:{fontSize:16,marginVertical:10}}),n(245)),pe=n(255),he=n(256),xe=i.default.create({centeredView:{flex:1,justifyContent:"center",alignItems:"center",marginTop:22},modalView:{margin:20,width:200,backgroundColor:"white",borderRadius:20,padding:35,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:4,elevation:5},button:{borderRadius:20,padding:10,elevation:2},buttonOpen:{backgroundColor:"#F194FF"},buttonClose:{backgroundColor:"#2196F3"},textStyle:{color:"white",fontWeight:"bold",textAlign:"center"},modalText:{marginBottom:15,textAlign:"center"}}),me=function(e){var t=e.isVisible,n=e.onClose,r=e.children;return Object(p.jsx)(V.default,{style:xe.centeredView,children:Object(p.jsx)(pe.default,{animationType:"slide",transparent:!0,visible:t,onRequestClose:function(){ge.default.alert("Modal has been closed."),n()},children:Object(p.jsx)(V.default,{style:xe.centeredView,children:Object(p.jsxs)(V.default,{style:xe.modalView,children:[r,Object(p.jsx)(he.default,{style:[xe.button,xe.buttonClose],onPress:function(){return n()},children:Object(p.jsx)(se.default,{style:xe.textStyle,children:"Hide Modal"})})]})})})})};function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pe=function(){var e,t=c.a.useState(!1),n=u()(t,2),r=n[0],i=n[1],a=Object(o.useState)(""),l=u()(a,2),s=l[0],d=l[1],f=Object(o.useContext)(j),b=u()(f,1)[0],O=function(e){var t=e.s3credentials,n=t.apiKey,r=t.apiSecret,i=t.region,c=t.endpoint,a=Object(o.useMemo)((function(){return n&&r&&c?(console.log("[useS3Client] Building S3 Client region = ",i),console.log("[useS3Client] Building S3 Client apiKey = ",n),[k({region:i,credentials:{accessKeyId:n,secretAccessKey:r},endpoint:c}),!0]):[void 0,!1]}),[n,r,i,c]),l=u()(a,2);return[l[0],l[1]]}(b),h=u()(O,2),x=h[0],m=h[1],y=Object(o.useState)({Bucket:b.s3credentials.bucket,Prefix:"",Delimiter:"/"}),v=u()(y,2),P=v[0],S=v[1];Object(o.useEffect)((function(){S(ve(ve({},P),{},{Bucket:b.s3credentials.bucket}))}),[b,x]);var C=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=Object(Q.useQuery)(["getAssets",r,n.Bucket||"",n.Delimiter||"",n.Prefix||""],w()((function*(){try{console.log("[useGetAssets] Getting data with params = ",n);var t=yield D(e,n),r=q(t,n);return console.log("[useGetAssets] Assets = ",r),r}catch(i){console.log("[useGetAssets] Error : ",i)}return[]})),{enabled:t,refetchOnWindowFocus:!1});return i}(x,m,P,s),I=C.data,E=C.isLoading,R=C.isError,B=function(e){S(ve(ve({},P),{},{Prefix:e}))};return Object(p.jsx)(p.Fragment,{children:m?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(g.Portal,{hostName:"Reloader",children:Object(p.jsx)(H.default,{animated:!0,icon:"reload",onPress:function(){d(""+Math.random())}})}),Object(p.jsx)(g.Portal,{hostName:"Back",children:(null==(e=P.Prefix)?void 0:e.length)>0&&Object(p.jsx)(H.default,{icon:"arrow-left",onPress:function(){!function(){var e=P.Prefix;if(""!==e){var t=e.substring(0,e.substring(0,e.length-1).lastIndexOf("/")+1);B(t)}}()}})}),Object(p.jsxs)(V.default,{style:we.root,children:[Object(p.jsxs)(V.default,{style:we.section1,children:[Object(p.jsx)(F.default,{variant:"bodyLarge",style:we.path,children:"Bucket Root /"+P.Prefix}),E&&Object(p.jsx)(J.default,{animating:!0}),R&&Object(p.jsx)(F.default,{variant:"headlineSmall",children:"Error "}),Object(p.jsx)(me,{isVisible:r,onClose:function(){i(!1)},children:Object(p.jsx)(F.default,{children:"Upload files here"})}),null!=I&&!E&&Object(p.jsx)(le,{assets:I,onPress:function(e){e.isFolder&&B(e.prefix)}}),Object(p.jsx)(W.default,{icon:"plus",onPress:function(){return i(!r)},visible:!0,style:[we.fabStyle]})]}),Object(p.jsx)(Oe,{hidden:["xs","md"],children:Object(p.jsx)(V.default,{style:we.section2,children:Object(p.jsx)(F.default,{variant:"bodyLarge",style:we.path,children:"Preview pane"})})})]})]}):Object(p.jsx)(A.default,{style:we.errorMessage,children:Object(p.jsx)(F.default,{children:"S3 Client has not been initialized, please update your API Configuration first."})})})},we=i.default.create({path:{margin:10},fabStyle:{bottom:45,right:25,position:"absolute"},errorMessage:{margin:12,padding:10},root:{flexDirection:"row",display:"flex",flex:1,flexGrow:1},section1:{flex:3,borderColor:"gray",borderRightWidth:2,flexDirection:"column"},section2:{minWidth:"30vw",flex:1,backgroundColor:"skyblue",flexGrow:1}});function Se(){return Object(p.jsx)(Pe,{})}var Ce=function(){var e=o.useState(0),t=u()(e,2),n=t[0],r=t[1],i=o.useState([{key:"assets",title:"Assets",focusedIcon:"folder"},{key:"api_configuration",title:"API Configuration",focusedIcon:"cogs"}]),c=u()(i,1)[0],a=x.default.SceneMap({assets:Se,api_configuration:G});return Object(p.jsx)(x.default,{navigationState:{index:n,routes:c},onIndexChange:r,renderScene:a})},ke=n(165),De=function(){var e=w()((function*(e){try{yield ke.default.setItem("byos/application",JSON.stringify(e))}catch(t){}}));return function(t){return e.apply(this,arguments)}}(),Ae=function(){var e=w()((function*(){try{var e=yield ke.default.getItem("byos/application");if(null!==e)return e}catch(t){}return""}));return function(){return e.apply(this,arguments)}}(),Fe=function(e){try{return JSON.parse(e)}catch(t){return{}}},Ie=function(){var e=w()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"{}",t=yield Ae();return Fe(t||e)}));return function(){return e.apply(this,arguments)}}(),Ee=function(){var e=w()((function*(e){return yield De(e),null}));return function(t){return e.apply(this,arguments)}}(),Re=n(143);function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ze=Me(Me({},Re.MD3LightTheme),{},{roundness:2,version:3,colors:Me(Me({},Re.MD3LightTheme.colors),{},{primary:"#eeeeee",secondary:"#112A46"})});function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ve=function(){var e=c.a.useContext(d),t=u()(e,1)[0],n=function(e){var t=Object(o.useState)(e),n=u()(t,2),r=n[0],i=n[1],c=Object(o.useState)(!1),a=u()(c,2),l=a[0],s=a[1];return Object(o.useMemo)((function(){Ie(JSON.stringify(e)).then((function(e){i(e),s(!0)})).catch((function(){console.log("[useGetApplicationStateFromLs] Promise failure getApplicationStateLS")}))}),[e]),{data:r,isLoaded:l}}(f),r=n.data,i=n.isLoaded,a=Object(o.useState)(r),s=u()(a,2),O=s[0],x=s[1];return Object(o.useEffect)((function(){x(r)}),[r]),Object(o.useEffect)((function(){i&&(console.log("[App] Application state was updated = ",O),Ee(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},O)))}),[O,i]),Object(p.jsx)(b.default,{theme:ze,children:Object(p.jsx)(g.PortalProvider,{children:Object(p.jsxs)(j.Provider,{value:a,children:[t.isReady&&t.routes.map((function(e){return null})),Object(p.jsx)(h,{title:"BYOS"}),Object(p.jsx)(Ce,{})]})})})};var Ne={isReady:!1,routes:[{path:"/credentials",component:Object(p.jsx)((function(){return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(K,{})})}),{}),showInNavigation:!0},{path:"/",component:Object(p.jsx)((function(){return Object(p.jsx)(p.Fragment,{})}),{}),showInNavigation:!0}]};function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ge=function(e){var t=e.children,n=c.a.useContext(d),r=u()(n,2),i=r[0],a=r[1];return Object(o.useEffect)((function(){!1===i.isReady&&a(Ke(Ke({},i),{},{isReady:!0}))}),[i.isReady,i.routes]),Object(p.jsx)(p.Fragment,{children:t})},He=n(376),Je=n(234),We=new He.QueryClient;function Qe(e){var t=e.children;return Object(p.jsx)(Je.QueryClientProvider,{client:We,children:t})}var qe=function(e){var t=e.children,n=Object(o.useState)(Ne);return Object(p.jsx)(Qe,{children:Object(p.jsx)(d.Provider,{value:n,children:Object(p.jsx)(Ge,{children:t})})})},Ye=function(){return Object(p.jsx)(qe,{children:Object(p.jsx)(Ve,{})})};i.default.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center"}});function _e(){return Object(p.jsx)(Ye,{})}Object(r.default)(_e),Object(r.default)(_e)}},[[267,1,2]]]);
//# sourceMappingURL=app.8c960813.chunk.js.map